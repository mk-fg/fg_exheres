# Copyright 2011 Mike Kazantsev
# Distributed under the terms of the GNU General Public License v2
# Based upon 'fossil-20100318142033.ebuild' from Gentoo, which is:
#  Copyright 1999-2010 Gentoo Foundation

MY_PNV="${PN}-src-${PV}"
WORK="${WORKBASE}/${MY_PNV}"

SUMMARY="Light distributed version control system, bug tracking system and wiki software server."

HOMEPAGE="http://www.fossil-scm.org/"
DOWNLOADS="http://www.fossil-scm.org/download/${MY_PNV}.tar.gz"

LICENCES="GPL-2"
SLOT="0"
PLATFORMS="~amd64 ~x86"
MYOPTIONS="
    no_ssl_check [[ description = [ Do not perform SSL certificate checks on sync operations ] ]]"

DEPENDENCIES="
    build+run:
        dev-db/sqlite[>=3.7.0]
        dev-libs/openssl
        sys-libs/zlib
    test:
        dev-lang/tcl
"

BUGS_TO="mk.fraggod@gmail.com"


src_configure() {
    # It's "autosetup", not "autoconf"
    # --with-tcl is disabled by default
    ./configure --prefix=/usr --with-openssl=/usr --json
}

src_install() {
    mkdir -p "$IMAGE"/usr/bin
    default
}
