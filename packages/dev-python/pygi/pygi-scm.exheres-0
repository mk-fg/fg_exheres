# Copyright 2011 Mike Kazantsev
# Copyright 2008 Saleem Abdulrasool <compnerd@compnerd.org>
# Distributed under the terms of the GNU General Public License v2

require gnome.org [ pn=pygobject ] scm-git python [ python_dep=2.5.2 ]\
    autotools [ supported_autoconf=[ 2.5 ] supported_automake=[ 1.11 ] ]

SUMMARY="Python Bindings for GObject, gtk-3.0 version"

HOMEPAGE="http://www.pygtk.org"

LICENCES="LGPL-2.1"
SLOT="3"
PLATFORMS="~amd64 ~x86"
MYOPTIONS=""

DEPENDENCIES="
    build:
        dev-util/pkg-config
    build+run:
        dev-libs/glib:2[>=2.24.0]
        dev-libs/libffi[>=3.0]
        dev-python/pycairo[>=1.2.0]
        gnome-bindings/pygobject
        gnome-desktop/gobject-introspection:1[>=0.10.2]
"

BUGS_TO="mk.fraggod@gmail.com"


RESTRICT="test"
DEFAULT_SRC_CONFIGURE_PARAMS=( --enable-cairo --enable-introspection )

src_prepare() {
    NOCONFIGURE=true ./autogen.sh
}

src_compile() {
    python_disable_pyc
    default

    edo cd gi
    emake
}

src_install() {
    edo cd gi
    emake DESTDIR="${IMAGE}" install

    python_bytecompile
}
