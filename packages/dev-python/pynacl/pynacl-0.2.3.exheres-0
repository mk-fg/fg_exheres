# Copyright 2014 Mike Kazantsev
# Distributed under the terms of the GNU General Public License v2

require distutils pypi checksums [ sha1=[ ${PNV}.tar.gz=533af9e6804f3f373b6c7b4f0e6f3d38f21854cd ] ]

SUMMARY="Python binding to the Networking and Cryptography (NaCl) library."

HOMEPAGE="http://pynacl.readthedocs.org/"
DOWNLOADS="https://pypi.python.org/packages/source/P/PyNaCl/PyNaCl-0.2.3.tar.gz -> ${PNV}.tar.gz"

LICENCES="Apache-2.0"
SLOT="0"
PLATFORMS="~amd64 ~x86"
MYOPTIONS=""

DEPENDENCIES=""

BUGS_TO="mk.fraggod@gmail.com"


src_prepare() {
    grep -F --disable-pie setup.py\
        || sed -i 's/\(configure, \)\("--disable-shared"\)/\1"--disable-pie", \2/' setup.py
}

src_compile() {
    : # "build" causes "File exists: .../build/temp.linux-i686-2.7" on install
}

src_install() {
    nonfatal edo python -B setup.py install --root=/var/tmp/paludis/build/dev-python-pynacl-scm/image/ --no-compile
    edo test -f "$IMAGE"/usr/$LIBDIR/python*/site-packages/nacl/__init__.py
}
