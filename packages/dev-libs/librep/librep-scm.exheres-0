# Copyright 2011 Mike Kazantsev
# Distributed under the terms of the GNU General Public License v2

require gnome.org scm-git sourceforge multilib autotools [ supported_autoconf=[ 2.5 ] supported_automake=[ 1.11 ] ]

SUMMARY="Shared library implementing a lightweight Lisp dialect."

DOWNLOADS=""

LICENCES="GPL-2"
SLOT="0"
PLATFORMS="~amd64 ~x86"
MYOPTIONS="
    emacs [[ description = [ Install rep-debugger module into emacs. ] ]]"

DEPENDENCIES="
    build:
        dev-util/pkg-config
    build+run:
        dev-libs/gmp
        dev-libs/libffi
        sys-libs/gdbm[>=1.8.0]
        sys-libs/readline
        emacs? ( app-editors/emacs )
"

BUGS_TO="mk.fraggod@gmail.com"
REMOTE_IDS="freshmeat:${PN}"


DEFAULT_SRC_CONFIGURE_PARAMS=(
    --libexecdir=/usr/$(get_libdir)
    --with-gmp --with-ffi --with-readline )

src_prepare() {
    # Nothing seem to create these files, producing the error:
    #  configure: error: cannot run /bin/sh ./config.sub
    # Not sure why it needs these at all, see #exherbo logs for 21.02.2010
    edo cp /usr/share/gnuconfig/config.{sub,guess} .
    eautoreconf
}

src_install() {
    default
    edo rmdir "${IMAGE}/usr/share/aclocal"
}
